<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>KubeSerial</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MF2CTP3H1C"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MF2CTP3H1C');
</script>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="intro.html"><strong aria-hidden="true">1.</strong> Intro</a></li><li class="chapter-item expanded "><a href="quick_start.html"><strong aria-hidden="true">2.</strong> Quick Start</a></li><li class="chapter-item expanded "><a href="configuration/SUMMARY.html"><strong aria-hidden="true">3.</strong> Configuration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="configuration/kubeserial.html"><strong aria-hidden="true">3.1.</strong> KubeSerial</a></li><li class="chapter-item expanded "><a href="configuration/devices.html"><strong aria-hidden="true">3.2.</strong> Devices</a></li><li class="chapter-item expanded "><a href="configuration/managers/SUMMARY.html"><strong aria-hidden="true">3.3.</strong> Managers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="configuration/managers/internal.html"><strong aria-hidden="true">3.3.1.</strong> Manager scheduled by KubeSerial</a></li><li class="chapter-item expanded "><a href="configuration/managers/external.html"><strong aria-hidden="true">3.3.2.</strong> Managed externaly</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="components/SUMMARY.html"><strong aria-hidden="true">4.</strong> Components</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="components/controllers.html"><strong aria-hidden="true">4.1.</strong> Controllers</a></li><li class="chapter-item expanded "><a href="components/monitor.html"><strong aria-hidden="true">4.2.</strong> Device Monitor</a></li><li class="chapter-item expanded "><a href="components/gateway.html"><strong aria-hidden="true">4.3.</strong> Device Gateway</a></li><li class="chapter-item expanded "><a href="components/manager.html"><strong aria-hidden="true">4.4.</strong> Manager</a></li></ol></li><li class="chapter-item expanded "><a href="development.html"><strong aria-hidden="true">5.</strong> Development</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">KubeSerial</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/janekbaraniewski/kubeserial" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="kubeserial"><a class="header" href="#kubeserial">KubeSerial</a></h1>
<p><mark>THIS IS STILL WORK IN PROGRESS</mark></p>
<p><b>Work with serial devices in Kubernetes</b></p>
<hr />
<p><mark>THIS IS STILL WORK IN PROGRESS</mark></p>
<p>KubeSerial is a set of Kubernetes controllers and resources that make working with serial devices in Kubernetes clusters easy. It decouples node that device is connected to from workload that's using it.</p>
<h2 id="how-it-works"><a class="header" href="#how-it-works">How it works</a></h2>
<p>KubeSerial uses <a href="/components/monitor.html" title="Device Monitor">Device Monitors</a> to monitor all cluster nodes for <a href="/configuration/devices.html" title="Device">Devices</a>. Once <a href="/configuration/devices.html" title="Device">Device</a> is detected, it will schedule <a href="/components/gateway.html" title="Device Gateway">Device Gateway</a> to specific cluster node. <a href="/components/gateway.html" title="Device Gateway">Device Gateway</a> exposes this device as TCP server. Once <a href="/components/gateway.html" title="Device Gateway">Device Gateway</a> is available, it can be used by <a href="/configuration/managers/SUMMARY.html" title="Managers">Manager</a>. There are 2 supported modes for <a href="/configuration/managers/SUMMARY.html" title="Managers">Managers</a>:</p>
<ul>
<li>Use predefined Manager that will be scheduled when Device is available</li>
<li>Use annotation to inject device to any workload</li>
</ul>
<!-- Links  -->
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/intro.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="quick-start"><a class="header" href="#quick-start">Quick Start</a></h1>
<ul>
<li><a href="quick_start.html#requirements">Requirements</a></li>
<li><a href="quick_start.html#install-with-helm">Install with Helm</a>
<ul>
<li><a href="quick_start.html#add-help-repo">Add help repo</a></li>
<li><a href="quick_start.html#install-crds">Install CRDs</a></li>
<li><a href="quick_start.html#create-minimal-values-file">Create minimal values file</a></li>
<li><a href="quick_start.html#install-controller">Install Controller</a></li>
</ul>
</li>
<li><a href="quick_start.html#get-device-attributes">Get device attributes</a></li>
<li><a href="quick_start.html#update-helm-values-file">Update helm values file</a></li>
<li><a href="quick_start.html#update-your-helm-release-with-new-values">Update your helm release with new values</a></li>
<li><a href="quick_start.html#validate-that-everything-is-working">Validate that everything is working</a></li>
</ul>
<h2 id="requirements"><a class="header" href="#requirements">Requirements</a></h2>
<ul>
<li>k8s cluster</li>
<li>CertManager installed and Cert Issuer configured</li>
</ul>
<h2 id="install-with-helm"><a class="header" href="#install-with-helm">Install with Helm</a></h2>
<h3 id="add-help-repo"><a class="header" href="#add-help-repo">Add help repo</a></h3>
<p>First you'll need to add helm repository that stores KubeSerial charts</p>
<pre><code class="language-bash">&gt; helm repo add baraniewski https://baraniewski.com/charts/
</code></pre>
<h3 id="install-crds"><a class="header" href="#install-crds">Install CRDs</a></h3>
<p>Due to way in which helm handles CRDs, they are managed using separate chart.</p>
<pre><code class="language-bash">&gt; helm upgrade --install kubeserial-crds baraniewski/kubeserial-crds
</code></pre>
<h3 id="create-minimal-values-file"><a class="header" href="#create-minimal-values-file">Create minimal values file</a></h3>
<p>In order to make webhook work, you'll need to specify which Cert Issuer should be used for SSL cert used by webhook. To do this, create values file with following structure (change values depending on your setup):</p>
<pre><code class="language-yaml">certManagerIssuer:
  name: selfsigned-issuer
  kind: ClusterIssuer
</code></pre>
<p><mark>Set proper name and kind of your Issuer or ClusterIssuer</mark></p>
<h3 id="install-controller"><a class="header" href="#install-controller">Install Controller</a></h3>
<pre><code class="language-bash">&gt; helm upgrade --install kubeserial baraniewski/kubeserial
</code></pre>
<h2 id="get-device-attributes"><a class="header" href="#get-device-attributes">Get device attributes</a></h2>
<p>To find out values of <code>idVendor</code> and <code>idProduct</code> for your device, connect it to your computer, locate where it is (let's say <code>/dev/ttyUSB0</code>) and run:</p>
<pre><code class="language-bash">&gt; udevadm info -q all -n /dev/ttyUSB0 --attribute-walk
</code></pre>
<p>Look for them from the top.</p>
<h2 id="update-helm-values-file"><a class="header" href="#update-helm-values-file">Update helm values file</a></h2>
<p>Now you're ready to create configuration for your devices. Here you can find example of 2 devices - one is using predefined manager, one doesn't. To learn about the difference, please refer to <a href="configuration/managers/SUMMARY.html">manager configuration docs</a></p>
<p>Add this config to your values file:</p>
<pre><code class="language-yaml">kubeserial:
  serialDevices:
  - idProduct: &quot;6001&quot;
    idVendor: &quot;0403&quot;
    manager: octoprint
    name: ender3
  - idProduct: ea60
    idVendor: 10c4
    name: sonoff-zigbee
</code></pre>
<h2 id="update-your-helm-release-with-new-values"><a class="header" href="#update-your-helm-release-with-new-values">Update your helm release with new values</a></h2>
<pre><code class="language-bash">&gt; helm upgrade kubeserial baraniewski/kubeserial -f my-values.yaml
</code></pre>
<h2 id="validate-that-everything-is-working"><a class="header" href="#validate-that-everything-is-working">Validate that everything is working</a></h2>
<p>You should see 3 workloads in your cluster - controler manager, device injector webhook and device monitor:</p>
<pre><code class="language-bash">$ ➜  kubectl get pods
NAME                                         READY   STATUS    RESTARTS   AGE
kubeserial-7d58555d4c-97nqk                  1/1     Running   0          5m
kubeserial-device-injector-cc7696b59-mfdn5   1/1     Running   0          5m
kubeserial-monitor-rjs82                     2/2     Running   0          5m
</code></pre>
<p>Number of <code>kubeserial-monitor</code> pods should match number of your cluster nodes.</p>
<p>You should also see your devices:</p>
<pre><code class="language-bash">$ ➜  kubectl get serialdevice
NAME            READY   AVAILABLE   NODE
ender3          True    False
sonoff-zigbee   True    False
</code></pre>
<p>You're all set with basic configuration of KubeSerial. Please read through rest of docs to configure it to your needs.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/quick_start.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="configuration"><a class="header" href="#configuration">Configuration</a></h1>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/configuration/SUMMARY.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="kubeserial-1"><a class="header" href="#kubeserial-1">KubeSerial</a></h1>
<pre><code class="language-yaml">apiVersion: app.kubeserial.com/v1alpha1
kind: KubeSerial
metadata:
  annotations:
    ...
  labels:
    ...
  name: kubeserial
  namespace: kubeserial
spec:
  ingress:
    enabled: false
  serialDevices:
  - idProduct: &quot;6001&quot;
    idVendor: &quot;0403&quot;
    manager: octoprint
    name: ender3
  - idProduct: ea60
    idVendor: 10c4
    name: sonoff-zigbee
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/configuration/kubeserial.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="device"><a class="header" href="#device">Device</a></h1>
<ul>
<li><a href="configuration/devices.html#spec">Spec</a></li>
<li><a href="configuration/devices.html#status-conditions">Status conditions</a></li>
</ul>
<h2 id="spec"><a class="header" href="#spec">Spec</a></h2>
<pre><code class="language-yaml">apiVersion: app.kubeserial.com/v1alpha1
kind: SerialDevice
metadata:
  annotations:
    ...
  labels:
    ...
  name: ender3
spec:
  idProduct: &quot;6001&quot;
  idVendor: &quot;0403&quot;
  manager: octoprint
  name: ender3
</code></pre>
<h2 id="status-conditions"><a class="header" href="#status-conditions">Status conditions</a></h2>
<pre><code class="language-yaml">apiVersion: app.kubeserial.com/v1alpha1
kind: SerialDevice
...
status:
  conditions:
  - lastHeartbeatTime: &quot;2022-06-05T23:49:02Z&quot;
    lastTransitionTime: &quot;2022-06-05T23:49:02Z&quot;
    message: &quot;&quot;
    reason: NotValidated
    status: &quot;False&quot;
    type: Available
  - lastHeartbeatTime: &quot;2022-06-05T23:49:02Z&quot;
    lastTransitionTime: &quot;2022-06-05T23:49:02Z&quot;
    message: &quot;&quot;
    reason: AllChecksPassed
    status: &quot;True&quot;
    type: Ready
  - lastHeartbeatTime: &quot;2022-06-05T23:49:02Z&quot;
    lastTransitionTime: &quot;2022-06-05T23:49:02Z&quot;
    message: &quot;&quot;
    reason: NotValidated
    status: &quot;False&quot;
    type: Free
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/configuration/devices.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="managers"><a class="header" href="#managers">Managers</a></h1>
<blockquote>
<p>In order to learn more about concept of Manager take a look at <a href="configuration/managers//components/manager.html" title="Manager">Manager docs</a></p>
</blockquote>
<p>Manager configuration is not required, although it's the easiest way to work with serial devices using KubeSerial.</p>
<p>There are 2 ways to work with managers. You can use them both at the same time for different devices, but not for the same one.</p>
<h2 id="manager-scheduled-by-kubeserial"><a class="header" href="#manager-scheduled-by-kubeserial">Manager scheduled by KubeSerial</a></h2>
<p>In this approach, you'll need to create <code>Manager</code> type object which will hold spec of manager software you want to run and bind it with <code>SerialDevice</code>. Then, when KubeSerial detects that device is connected, it will schedule management software for you and create link to the device inside. Once device is disconnected, everything is cleaned up. Learn how to configure it by <a href="configuration/managers//configuration/managers/internal.html" title="Manager internal">reading the docs</a></p>
<h2 id="manager-scheduled-externaly"><a class="header" href="#manager-scheduled-externaly">Manager scheduled externaly</a></h2>
<p>In this approach, you add annotation to your Pod and KubeSerial mutating webhook will update pod spec when it's created to inject connection to device. Learn how to configure it by <a href="configuration/managers//configuration/managers/external.html" title="Manager external">reading the docs</a></p>
<!-- Links  -->
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/configuration/managers/SUMMARY.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="manager-scheduled-by-kubeserial-1"><a class="header" href="#manager-scheduled-by-kubeserial-1">Manager scheduled by KubeSerial</a></h1>
<pre><code class="language-yaml">apiVersion: app.kubeserial.com/v1alpha1
kind: Manager
metadata:
  annotations:
    meta.helm.sh/release-name: kubeserial
    meta.helm.sh/release-namespace: kubeserial
  creationTimestamp: &quot;2022-06-05T23:48:43Z&quot;
  generation: 1
  labels:
    app.kubernetes.io/instance: kubeserial
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: kubeserial
    app.kubernetes.io/version: 0.0.1-8c68648
    helm.sh/chart: kubeserial-0.0.1-8c68648
  name: octoprint
  resourceVersion: &quot;43158&quot;
  uid: c908bad7-8716-4f50-aa3f-aeb91bebe71f
spec:
  config: |
    accessControl:
      enabled: false
    plugins:
      announcements:
        _config_version: 1
        channels:
          _blog:
            read_until: 1573642500
          _important:
            read_until: 1521111600
          _octopi:
            read_until: 1573722900
          _plugins:
            read_until: 1573862400
          _releases:
            read_until: 1574699400
      discovery:
        upnpUuid: ef35acc7-a859-4947-980d-d5edb10508e4
      softwareupdate:
        _config_version: 6
      tracking:
        enabled: false
    deviceProfiles:
      default: _default
    serial:
      additionalPorts:
      - /dev/devices/ender3
      autoconnect: true
      baudrate: 0
      port: /dev/device
    server:
      firstRun: false
      onlineCheck:
        enabled: true
      pluginBlacklist:
        enabled: false
      seenWizards:
        corewizard: 3
        cura: null
        tracking: null`
  configPath: /data/config.yaml
  image:
    repository: janekbaraniewski/octoprint
    tag: 1.3.10
  runCmd: mkdir /root/.octoprint &amp;&amp; cp /data/config.yaml /root/.octoprint/config.yaml
    &amp;&amp; /OctoPrint-1.3.10/run --iknowwhatimdoing --port 80
</code></pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/configuration/managers/internal.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="manager-scheduled-externaly-1"><a class="header" href="#manager-scheduled-externaly-1">Manager scheduled externaly</a></h1>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/configuration/managers/external.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="components"><a class="header" href="#components">Components</a></h1>
<ul>
<li><a href="components/./controllers.html">Controllers</a></li>
<li><a href="components/./monitor.html">Device Monitor</a></li>
<li><a href="components/./gateway.html">Device Gateway</a></li>
<li><a href="components/./manager.html">Manager</a></li>
</ul>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/components/SUMMARY.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="controller"><a class="header" href="#controller">Controller</a></h1>
<p>Manages operator components by observing state of each of the devices.</p>
<ul>
<li><a href="components/controllers.html#controller-loops">Controller Loops</a>
<ul>
<li><a href="components/controllers.html#kubeserial-controller">KubeSerial Controller</a></li>
<li><a href="components/controllers.html#serialdevice-controller">SerialDevice Controller</a></li>
<li><a href="components/controllers.html#managerschedulerequest-controller">ManagerScheduleRequest Controller</a></li>
</ul>
</li>
</ul>
<h1 id="controller-loops"><a class="header" href="#controller-loops">Controller Loops</a></h1>
<h2 id="kubeserial-controller"><a class="header" href="#kubeserial-controller">KubeSerial Controller</a></h2>
<h2 id="serialdevice-controller"><a class="header" href="#serialdevice-controller">SerialDevice Controller</a></h2>
<h2 id="managerschedulerequest-controller"><a class="header" href="#managerschedulerequest-controller">ManagerScheduleRequest Controller</a></h2>
<pre class="mermaid">graph TD;
    A--&gt;B;
    A--&gt;C;
    B--&gt;D;
    C--&gt;D;
</pre>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/components/controllers.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="serialdevicemonitor"><a class="header" href="#serialdevicemonitor">SerialDeviceMonitor</a></h1>
<p>Monitors cluster nodes waiting for specified serial devices to be connected and updates their state.</p>
<ul>
<li><a href="components/monitor.html#how-it-works">How it works</a></li>
</ul>
<h2 id="how-it-works-1"><a class="header" href="#how-it-works-1">How it works</a></h2>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/components/monitor.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="serialdevice-gateway"><a class="header" href="#serialdevice-gateway">SerialDevice Gateway</a></h1>
<p>Exposed specific device in cluster network over TCP.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/components/gateway.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="manager"><a class="header" href="#manager">Manager</a></h1>
<p>Creates deployment with management software, mounts your device over the network and gives you access through ingress rule.</p>
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/components/manager.md">Edit this file on GitHub.</a></footer><div style="break-before: page; page-break-before: always;"></div><h1 id="development"><a class="header" href="#development">Development</a></h1>
<ul>
<li><a href="development.html#intro">Intro</a></li>
<li><a href="development.html#running-tests">Running tests</a></li>
<li><a href="development.html#building-images">Building images</a>
<ul>
<li><a href="development.html#building-images-localy">Building images localy</a></li>
</ul>
</li>
<li><a href="development.html#running-minikube">Running minikube</a></li>
</ul>
<h2 id="intro"><a class="header" href="#intro">Intro</a></h2>
<p>Most things you'd need for local development are covered in Makefile. Just run <code>make help</code> to see available commands:</p>
<pre><code class="language-zsh">➜  make help

Usage:
  make &lt;target&gt;

General
  help             Display this help.

Development
  fmt              Run go fmt against code.
  vet              Run go vet against code.
  test             Run tests.
  test-fswatch     Use fswatch to watch source files and run tests on chamnge

Run
  run              Run codegen and start controller from your host.

Docker
  kubeserial-docker-local        Build image for local development, tag local, supports only builder platform
  kubeserial-docker-all          Build and push image for all target platforms
  device-monitor-docker-local    Build image for local development, tag local, supports only builder platform
  device-monitor-docker-all      Build and push image for all target platforms
  injector-webhook-docker-local  Build image for local development, tag local, supports only builder platform
  injector-webhook-docker-all    Build and push image for all target platforms

Helm
  update-kubeserial-chart-version       Update version used in chart. Requires VERSION var to be set
  update-kubeserial-crds-chart-version  Update version used in chart. Requires VERSION var to be set
  helm-lint                             Run chart-testing to lint kubeserial chart.

Kind

Minikube
  minikube              Start local cluster, build image and deploy
  minikube-start        Start minikube cluster
  minikube-set-context  Set context to use minikube cluster
  minikube-deploy       Deploy the app to local minikube

Deployment
  uninstall        Uninstall release.
  deploy-dev       Install dev release in current context/namespace.

Docs
  docs-deps        Install mdbook (requires rust and cargo) + plugins
  docs-serve       Build docs, start server and open in browser

Build
  kubeserial        Build manager binary.
  device-monitor    Build device monitor binary
  injector-webhook  Build sidecar injector webhook binary binary
  all               Run codegen and build all components.
</code></pre>
<h2 id="running-tests"><a class="header" href="#running-tests">Running tests</a></h2>
<p>After any change run</p>
<pre><code class="language-bash">$ make test
</code></pre>
<p>to run tests suite</p>
<p>You can also find it helpful to just run tests every time there is a change in project source files, for this run</p>
<pre><code class="language-bash">$ make test-fswatch
</code></pre>
<p>which will run <code>test</code> target every time it detects change using <code>fswatch</code> (<code>fswatch</code> must be installed)</p>
<h2 id="building-images"><a class="header" href="#building-images">Building images</a></h2>
<p>There are sets of 2 targets for each image that is a part of this project:</p>
<blockquote>
<p>*-docker-local</p>
</blockquote>
<p>which builds docker image for local development</p>
<p>and </p>
<blockquote>
<p>*-docker-all</p>
</blockquote>
<p>which builds docker image for all target architectures.</p>
<p>For local development you'll only need to build local images</p>
<h3 id="building-images-localy"><a class="header" href="#building-images-localy">Building images localy</a></h3>
<p><mark>Docker buildx builder with support for platforms listed in TARGET_PLATFORMS is required</mark></p>
<p>If you want to build all images using your local Docker, run</p>
<pre><code class="language-zsh">$ make docker-local 
</code></pre>
<p>This will execute all <code>*-docker-local</code> targets and build images using your local Docker.</p>
<h2 id="running-minikube"><a class="header" href="#running-minikube">Running minikube</a></h2>
<p>TODO</p>
<!-- TODO -->
<footer id="open-on-gh">Found a bug? <a href="https://github.com/janekbaraniewski/kubeserial/edit/main/docs/src/development.md">Edit this file on GitHub.</a></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="mermaid.min.js"></script>
        <script type="text/javascript" src="mermaid-init.js"></script>
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
